<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Meshnet : Practical Guide</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">


				<section>

					<h1>MESH NETWORK</h1>
					<h2>A Practical Guide</h2>

					<p>
					<small>Created by <a href="https://github.com/suriyadeepan"> Suriyadeepan</a> and <a href="https://github.com/vanangamudi">  Selva Kumar</a></small>
					</p>



				</section>

				<section> <h1>Routing</h1> </section>

<!--					<li class="fragment">Routing</p>
					<li class="fragment">Openwrt</p>
					<li class="fragment">Ping Tests</p>
					<li class="fragment">DNS and IP</p>
					<li class="fragment">P2P Applications</p>
					<li class="fragment">Use Cases</p>
					<li class="fragment">Principles</p>

				</section>
-->

				<section data-markdown>
					<script type="text/template">

## Protocols

* [Babel](https://www.irif.univ-paris-diderot.fr/~jch/software/babel/)
* [BATMAN](https://www.open-mesh.org/projects/open-mesh/wiki/BATMANConcept)
* [OLSR](http://www.olsr.org/mediawiki/index.php/Main_Page)
* [BMX6](http://bmx6.net/projects/bmx6)


					</script>
				</section>


				<section>

					<section> <h2>BABEL</h2>
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
					</section>
					<section> <h2>B.A.T.M.A.N.</h2>
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
					</section>
					<section> <h2>OLSR</h2>
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
					</section>
					<section> <h2>BMX6</h2>
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
						loras ipsum. hipster hispanic.
					</section>

				</section>

				<section><h1>Implementation</h1></section>

				<section>
					<section><h2>batman-adv</h2> <br>
						<ul>
						<li>Implemented as a linux kernel module </li><br>
							<li>Operates on layer 2 of network stack</li>
						</ul>
					</section>
					<section><h2>batman-adv</h2><br>
						<ul>
							<li>All the packets are encapsulated and routed by <strong>batman-adv</strong></li><br>
							<li>All the participating nodes appear to be link-local</li>
						</ul>
					</section>
					<section><h2>batman-adv</h2><br>
						<ul>
							<li>Supports anything on top of layer 2 : <strong>IPV4, IPV6, DHCP, IPX</strong></li><br>
							<li>Nodes can participate in a mesh without having an IP</li><br>
							<li>Easy integration of non-mesh clients (think Android)</li>
						</ul>
					</section>
				</section>

				<section>
					<section><h2>batctl</h2> <br>
						<ul>
						<li>A tool to configure and debug the batman-adv kernel module</li><br>
						<li>Interface to settings and status information of batman-adv</li><br>
							<li>Provides a layer-2 version of ping, traceroute and tcpdump(MAC)</li>
						</ul>
					</section>
					<section><h2>Configuration</h2><br>
						<ul>
							<li>Add and remove interfaces to the mesh network</li><br>
							<li>Set or change parameters of batman-adv module</li><br>
							<li>Enable or disable features of batman-adv</li>
						</ul>
					</section>
					<section><h2>batctl</h2><br>
						<ul>
							<li>Get the list of mesh nodes and non-mesh nodes in the network</li><br>
							<li>Log messages from batman-adv</li><br>
							<li>List of available gateways</li>
						</ul>
					</section>
				</section>

				<section><h1>Compilation</h1></section>

				<section>
					<section><h2>Compatibility Check</h2> <br>
						Before compiling batman-adv or batctl find the versions compatible with your kernel.
					</section>
					<section>
					<h2>Kernel Version</h2>
					<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
					uname -r # 3.19.0-25-generic
					</code></pre>
				</section>
				<section><h2>Find compatible versions</h2>
					<a href="https://www.open-mesh.org/projects/open-mesh/wiki/Download">From here</a>
					<img data-src="res/compat.png" width=800 height=500>
					</section>
					
					<section><h2>Dowload</h2>
						<a href="https://downloads.open-mesh.org/batman/releases/">Download batclt and batman-adv</a>
					</section>

					<!--<section data-transition="slide" data-background="#b5533c" data-background-transition="zoom"><h2>Compile batman-adv</h2>-->
					<section data-transition="slide" data-background="#4d7e65" data-background-transition="zoom"><h2>Compile batman-adv</h2>
					<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
# compile
make -j4
# find module
ls *.ko
# insert module
sudo insmod batman-adv.ko
# check version
batctl -v
					</code></pre>
					</section>

					<section data-transition="slide" data-background="#b5533c" data-background-transition="zoom"><h2>Compile batctl</h2>
					<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
# compile
make -j4
# install
sudo make install
# check version
batctl -v
					</code></pre>
					</section>


				</section>


				<!-- Bridging starts here -->
				<section><h1>Quick Node setup</h1></section>
				<section>

					<section><h2>Add Interface</h2>
						<p>Which interface to add to batman-adv to build the mesh network?</p>
						<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
# Add an interface wlan0/eth0
batctl if add wlan0
# check interface
batctl if
						</code></pre>
					</section>

					<section><h2>bat0 : Virtual Interface</h2>
 Any packet that enters this interface will be examined by the batman-adv for its destination mac-adress and will be forwarded.
 <img data-src="res/bat0.png">
					</section>

					<section><h2>Simple Mesh Network</h2>
						<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
# kill network manager
sudo service network-manager stop
# load the module up
modprobe batman-adv
# setup network interfaces
ip link set up dev eth0
# set mtu compatible with batman
ip link set mtu 1532 dev wlan0
# configure the wlan interface to operate with mtus of 1532
#		(batman requires it) and turn enc off 
iwconfig wlan0 mode ad-hoc channel 6 essid PYMESH ap 02:12:34:56:78:9A enc off
# add wlan0 to the batman-adv virtual interface
# 	(so it can communicate with other batman-adv nodes)
batctl if add wlan0
# bringing up wireless ad-hoc interface
ifconfig wlan0 up
# bringing up bat0 interface
ifconfig bat0 192.168.1.4 up
						</code></pre>
					</section>

					<section><h2>How to kill BATMAN?</h2>
						<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
# disable kernel module
rmmod batman-adv
# restart network manager
service network-manager restart
					</pre></code>
				</section>

					<section><h2>Bridge</h2>
						<p>Need to bridge Adhoc and Infrastructure APs</p> 
						<p>To let non-mesh nodes (think Android) connect to the network</p>
					</section>
					<section><h2>Setup Bridge Interface</h2>
						<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
ip link add name mesh-bridge type bridge
ip link set dev eth0 master mesh-bridge
ip link set dev bat0 master mesh-bridge
ip link set up dev eth0
ip link set up dev bat0
ip link set up dev mesh-bridge
					</pre></code>
				</section>

				</section>

				<!-- Bridging ends here  -->

				<section><h1>Openwrt</h1> </section>

				<section>
					<section><h2>Compatibility Check</h2>
						<a href="https://wiki.openwrt.org/toh/start">Table of Hardware</a>
						<img data-src="res/toh.png" height=400 width=800>
					</section>

					<section><h2>Compiled Packages</h2>
						<a href="https://downloads.openwrt.org/">downloads.openwrt.org/</a>
						<img data-src="res/compiled.png" width=800 height=500>
					</section>

					<section><h2>Flashing your Router</h2>
						<img data-src="res/flashing.png" width=800 height=500>
					</section>

					<section><h2>LUCI Interface</h2>
						<img data-src="res/luci.png" width=800 height=500>
					</section>

				</section>

<!--DNS & IP : STARTS HERE -->
<section><h1>IP & DNS</h1> </section>
<section>
	<section><h2>IP Allocation. How? </h2><br>
		<ol>
			<li><b>Static IP</b><br>Manually setting a static IP address</li><br>
				<li><b>DHCP</b><br>OpenWrt comes with DHCP server</li>
		</ol>
	</section>

	<section>
		<h2>Configuring DHCP</h2><br>
		<ul><li>Go to <em>/etc/config/dhcp	</em></li>
			<li><strong>start</strong> : start address</li>
			<li><strong>limit</strong> : number of devices to serve</li>
		</ul>
	</section>
	<section>
		<h3>/etc/config/dhcp</h3><br>
		<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
config dhcp 'lan'
      option interface 'lan'
      option start '100'
      option limit '100'
      option leasetime '12h'
		</code></pre><br>

		<h3>/etc/config/network</h3><br>
		<pre><code class="bash" data-trim contenteditable style="font-size: 18px;">
config interface 'lan'
    option ipaddr '192.168.1.1'
    option netmask '255.255.255.0'
		</code></pre>

	</section>

</section>

<section>
	<section><h2>What is DNS? </h2><br>
		<ul>
			<li>Domain Name Server</li><br>
			<li>Human readable names for services</li>
		</ul>
	</section>
	<section><h2>How does it work?</h2><br>
		<ol>
			<li>The browser talks to the DNS server, asks for name resolution</li><br>
			<li>DNS maintains the mapping between name to IP address</li> <br>
			<li>DNS server looks in its map and reponds with the IP address</li>
		</ol>
	</section>
	<section><h2>How do we do it?</h2><br>
		OpenWRT comes with a DNS utility called <strong>Dnsmasq</strong>.<br><br>
		It can be configured through the <strong>LUCI</strong> interface.
	</section>
	<section><h2>Dnsmasq Configuration</h2><br>
		<ol>
			<li>Find the IP address allocated to your laptop; say <strong>192.168.1.162</strong></li><br>
			<li>To add a mapping entry, log in to the router, via ssh</li><br>
			<li>Create a new file under directory /etc/, <em>"hosts.pymesh"</em></li><br>
			<li>add the following line to the file</em></li>
		</ol>
		<pre><code class="bash" data-trim contenteditable style="font-size: 18px;"> 192.168.1.162 pymesh.p2p</code></pre>
	</section>
	<section><h2>Dnsmasq Configuration</h2><br>
		<ol>
			<li>Log into the router, via browser</li><br>
			<li>Go to DHCP and DNS configuration page, In the top menu click Network -> DHCP and DNS.</li><br>
			<li>In the Additional Hosts Files field(highlighted in the figure below) add the name of the file which we have created above.</li><br>
			<li>Click Save & Apply</li>
		</ol>
	</section>

	<section><h2>Dnsmasq Configuration</h2><br>
		<img data-src="res/dns.png">
	</section>
</section>
	
<!--DNS & IP : ENDS HERE   -->

<!-- P2P Apps : STARTS HERE -->
<section><h1>P2P Apps</h1></section>
<section>

	<section><h2>Use Cases</h2><br>
		<ul>
			<li>Chat</li><br>
			<li>Voice Call</li><br>
			<li>Social Networking</li><br>
			<li>Micro-blogging</li><br>
			<li>File Sharing</li><br>
			<li>Personal Website : Portfolio</li><br>
			<li>Knowledge sharing</li><br>
		</ul>
	</section>

	<section><h2>Serval Project</h2>
		<blockquote>Communications should not just be for the geographically, financially otherwise fortunate — for it is the unfortunate who need it most.</blockquote>
	</section>
	<section><h2>Serval Project</h2><br>
		<ol>
			<li>Communicate anytime</li><br>
			<li>Communicate anywhere</li><br>
			<li>Communicate privately</li><br>
			<li>Communicate with people</li><br>
		</ol>
	</section>
	<section><h2>Batphone for Android</h2>
		<img data-src="res/serval.jpg" height=500>
		<img data-src="res/serval2.jpg" height=500>
		<img data-src="res/serval3.png" height=500>
	</section>

	<section><h2>Rumble</h2><br>
		<img data-src="res/rumble.png" height=500>
		<img data-src="res/rumble1.png" height=500>
		<img data-src="res/rumble2.png" height=500>
	</section>
	<section><h2>Rumble</h2><br>
		<ul>
			<li>Decentralized and delay-tolerant twitter-like mobile application</li><br>
			<li>Enables the spread of messages in an epidemic fashion using automatically formed and opportunistic local ad-hoc network</li><br>
			<li>Every message sent or received with are stored on the local database and pushed to every other device it meets</li> <br>
			<li>Messages naturally propagates throughout the network using social links as the underlying infrastructure</li><br>
		</ul>
</section>
		<section><h2>Briar Project</h2>
			<img data-src="res/briar1.png" height=200>
			<small>Typical messaging software relies on central servers and exposes messages and relationships to surveillance</small>
			<img data-src="res/briar.png" height=200>
			<small>Direct, encrypted connections between users to prevent surveillance and censorship</small> 
		</section>

		<section><h2>Briar Project</h2><br>
			<ul>
				<li>Peer-to-peer encrypted messaging and forums</li><br>
				<li>Messages are stored securely on your device, not in the cloud</li><br>
				<li>Connect directly with nearby contacts - no Internet access required</li><br>
				<li>Free and open source software</li><br>
				<li>Designed for activists, journalists, and anyone else who needs a safe, easy and robust way to communicate</li><br>
			</ul>
		</section>

		<section><h2>Open Tracker</h2>
			<img data-src="res/opentracker.png" height=300>
			<p>opentracker is a open and free bittorrent tracker project.</p> 
			<p>It aims for minimal resource usage and is intended to run at your wlan router.</p> 
		</section>

		<section><h2>Open Tracker</h2>
			<p>A torrent tracker basically is an http-Server that collects all clients ip addresses into pools sorted by one of the request strings parameters and answers all other clients that specified this exact same parameter a list of all other recent clients.</p><br>
<a href="https://github.com/nandub/opentracker-openwrt">OpenTracker for OpenWrt</a>
		</section>

</section>
<!-- P2P Apps : ENDS   HERE -->

<!-- Knowledge Sharing : STARTS HERE-->
<section><h1>Knowledge Sharing</h1></section>

<section>

	<section><h2>Kiwix</h2>
		<img data-src="res/kiwix.svg"> 
		<ul>
			<li>An Offline web browser to browse wikipedia content</li>
			<li>Serves offline content from dump files called zim files</li>
		</ul>
	</section>

	<section><h2>Zim Files</h2>
		<a href="http://download.kiwix.org/zim/">download.kiwix.org/zim/</a><br>
		<img data-src="res/kiwix1.png">
	</section>

	<section><h2>Download Kiwix</h2>
		<p>Download Kiwix from <a href="https://sourceforge.net/projects/kiwix/files">here</a>.</p>
	</section>

	<section><h2>Launch Kiwix</h2>
		<p>Run the executable file named <em>kiwix</em>.</p>
		<img data-src="res/kiwix2.png">
	</section>

	<section><h2>Open Zim File</h2>
		<img data-src="res/kiwix3.png">
	</section>

	<section><h2>Choose Zim File</h2>
		<img data-src="res/kiwix4.png">
	</section>
	<section><h2>Browse Offline Content</h2>
		<img data-src="res/kiwix5.png">
	</section>
	<section><h2>Serve Local Content</h2>
		<img data-src="res/kiwix6.png" ><br>
		<img data-src="res/kiwix7.png">
	</section>
	<section><h2>Libre Digital Library</h2><a href="https://www.facebook.com/karaiglug/">Karai GLUG</a>, <a href="http://alagappauniversity.ac.in/">Alagappa University</a>
		<blockquote>Inspired by Puducherry Community WiFi Initiative(pymesh), we would like to kick start the mesh network in Karaikudi too.</blockquote>
	</section>
	<section>
		<img data-src="res/kglug/1.jpg" height=650>
		<img data-src="res/kglug/6.jpg" height=650>
	</section>
	<section>
		<img data-src="res/kglug/3.jpg" height=650>
		<img data-src="res/kglug/5.jpg" height=650>
	</section>


</section>
<!-- Knowledge Sharing : ENDS   HERE-->



<!-- Zero Configuration : STARTS   HERE-->
<section><h1>Zero Conf</h1></section>
<!-- Zero Configuration : ENDS     HERE-->
<section>
	<section><h2>Motivation</h2>
		<p>In the current model of Internet, or any large network, both providing a service and connecting to a service are unnecessarily complicated.</p>
		<p>To make a service visible, one needs to register a name as proxy to the service (IP + PORT).</p> 
		<p>To find a needed service, one needs support from a centralized DNS server.</p>
		<p><b>This is where zeroconf comes in.</b></p> 		
			</section>

			<section><h2>Pillars of Zero Conf</h2>
				<p>A set of technologies that automatically creates a usable computer network</p>
				<p><strong>Three Pillars of Zero Conf are</strong></p>
				<ol>
					<li>Address Selection</li><br>
					<li>Name Resolution</li><br>
					<li>Service Discovery</li><br>
				</ol>
			</section>

			<section><h2>Service Discovery</h2>
				<blockquote>Do you speak my language?</blockquote>
				<ul>
					<li>ZeroConf is a three-layered system with Service Discovery on top of naming and addressing</li><br>
					<li>Logical Services as primary entities on the network</li><br>
					<li>Discovery/Advertisement of <strong>services</strong> instead of hardware/software</li><br>
					<li>A new device connected to the network should learn the services available in the network rather than being manually configured by the user</li>
				</ul>
			</section>
			<section><h2>Service Discovery</h2>
				<ul>
					<li>Periodic (sensible) querying for services</li><br>
					<li>When a service is started it sends out multicast messages</li><br>
					<li>When a service stops its sends out multicast "good bye"</li><br>
					<li>Leases are given to services, if they are not renewed, the service name will not appear on the list of services on the client device</li>
				</ul>
			</section>


			<section><h2>Address Selection</h2>
				<ul>
					<li>Claiming an IP : ARP messages to know if the IP is already in use</li><br>
					<li><b>ARP Probe</b> : An ARP request with Sender IP as all zeros is sent with a target address that is desired by the host</li><br>
					<li>Sender MAC address is put into the ARP req, to identify if the request is from the host itself or some other device desiring the same address</li><br>
				</ul>
			</section>

			<section><h2>Announcement</h2>
				<ul>
					<li>After claiming an IP address (by querying for desired IP using ARP requests), a host announces <strong>I am 10.4.2.45</strong></li><br>
					<li>Announcing the claim is essential to flush the old MAC-IP mapping in the neighbours' ARP cache</li><br>
					<li>Announce the IP by sending Sender and Target addresses as same claimed address</li>
				</ul>
			</section>

			<section><h2>Defending an IP</h2>
				<ul>
					<li>When the host is offline for a while it needs to claim the address again, since some other device could have claimed the address while the host is offline</li><br>
					<li>Reply to ARP request from competitors looking to claim what is rightfully yours </li><br>
					<li>Back off and choose a different IP in time of conflict</li>
				</ul>
			</section>


			<section><h2>Name Resolution</h2>
				<ul>
					<li>Translate between names and IP addresses without a DNS server</li><br>
					<li>A multi-cast DNS (mDNS) server is a distributed DNS server that exists simply because all the machines on a local subnet run a special daemon</li><br>
					<li>Daemons running on either sides of a router can’t discover each other, so the .local domain is restricted to the local-link</li>
				</ul>
			</section>
			<section><h2>How does it work?</h2>
				<ul>
					<li>IP multicast query message that asks the host having that name to identify itself</li><br>
					<li>The target machine then multicasts a message that includes its IP address</li><br>
					<li>All machines in that subnet can then use that information to update their mDNS caches</li><br>
					<li>Devices can refer to the target computer by name, eg : <em>ping my_name.local, ssh my_name.local, ftp my_name.local</em></li>
				</ul>
			</section>
			<section><h1>Implementation</h1></section>
			<section>
				<h3>Apple's Bonjour</h3>
				<p>Bonjour is Apple's implementation of zero-configuration networking (zeroconf), a group of technologies that includes service discovery, address assignment, and hostname resolution. Bonjour locates devices such as printers, other computers, and the services that those devices offer on a local network using multicast Domain Name System (mDNS) service records.</p>
			</section>
			<section>
				<h3>Avahi</h3>
						<p>Avahi is a system which facilitates service discovery on a local network via the mDNS/DNS-SD protocol suite. This enables you to plug your laptop or computer into a network and instantly be able to view other people who you can chat with, find printers to print to or find files being shared.</p>
			</section>

</section>

<!-- Zeronet : Decentralization and Security STARTS HERE -->
<section><h1>Zeronet</h1><h3>Encryption and Decentralization</h3></section>
<section>

	<section><h2>What is Zeronet?</h2>

	</section>

</section>
<!-- Zeronet : Decentralization and Security ENDS   HERE -->

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'concave', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
